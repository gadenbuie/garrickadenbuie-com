---
title: "&#x1F939; tidyexplain"
date: '2018-08-27'
description: Animations of tidyverse verbs using R, the tidyverse, and gganimate
twitterImage: /project/tidyexplain/images/static/png/original-dfs.png
slug: tidyexplain
type: page
categories: ["Project"]
tags:
  - Data Analysis
  - Visualization
  - SQL
  - dplyr
  - tidyr
  - R
--- 

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="tidy-animated-verbs" class="section level2">
<h2>Tidy Animated Verbs</h2>
<!-- https://buttons.github.io/ -->
<p><a class="github-button" href="https://github.com/gadenbuie" data-show-count="true" aria-label="Follow @gadenbuie on GitHub">Follow <span class="citation">@gadenbuie</span></a> 
<a class="github-button" href="https://github.com/gadenbuie/tidyexplain" data-icon="octicon-star" data-show-count="true" aria-label="Star gadenbuie/tidyexplain on GitHub">Star</a> 
<a class="github-button" href="https://github.com/gadenbuie/tidyexplain/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork gadenbuie/tidyexplain on GitHub">Fork</a></p>
<ul>
<li><p><a href="#mutating-joins"><strong>Mutating Joins</strong></a> —
<a href="#inner-join"><code>inner_join()</code></a>, <a href="#left-join"><code>left_join()</code></a>,
<a href="#right-join"><code>right_join()</code></a>, <a href="#full-join"><code>full_join()</code></a></p></li>
<li><p><a href="#filtering-joins"><strong>Filtering Joins</strong></a> —
<a href="#semi-join"><code>semi_join()</code></a>, <a href="#anti-join"><code>anti_join()</code></a></p></li>
<li><p><a href="#set-operations"><strong>Set Operations</strong></a> — <a href="#union"><code>union()</code></a>,
<a href="#union-all"><code>union_all()</code></a>, <a href="#intersection"><code>intersect()</code></a>,
<a href="#set-difference"><code>setdiff()</code></a></p></li>
<li><p><a href="#tidy-data"><strong>Tidy Data</strong></a> — <a href="#spread-and-gather"><code>spread()</code> and
<code>gather()</code></a></p></li>
<li><p>Learn more about</p>
<ul>
<li><a href="#usage">Using the animations and images</a></li>
<li><a href="#relational-data">Relational Data</a></li>
<li><a href="#gganimate">gganimate</a></li>
</ul></li>
</ul>
</div>
<div id="background" class="section level2">
<h2>Background</h2>
<div id="usage" class="section level3">
<h3>Usage</h3>
<p>Please feel free to use these images for teaching or learning about
action verbs from the <a href="https://tidyverse.org">tidyverse</a>. You can
directly download the <a href="https://github.com/gadenbuie/tidyexplain/blob/master/images/">original animations</a> or static images in
<a href="https://github.com/gadenbuie/tidyexplain/blob/master/images/static/svg/">svg</a> or <a href="https://github.com/gadenbuie/tidyexplain/blob/master/images/static/png/">png</a> formats, or you
can use the <a href="https://github.com/gadenbuie/tidyexplain/blob/master/R/">scripts</a> to recreate the images locally.</p>
<p>Currently, the animations cover the <a href="https://dplyr.tidyverse.org/articles/two-table.html">dplyr two-table
verbs</a> and I’d like
to expand the animations to include more verbs from the tidyverse.
<a href="https://github.com/gadenbuie/tidy-animated-verbs/issues">Suggestions are
welcome!</a></p>
</div>
<div id="relational-data" class="section level3">
<h3>Relational Data</h3>
<p>The <a href="http://r4ds.had.co.nz/relational-data.html">Relational Data</a>
chapter of the <a href="http://r4ds.had.co.nz/">R for Data Science</a> book by
Garrett Grolemund and Hadley Wickham is an excellent resource for
learning more about relational data.</p>
<p>The <a href="https://dplyr.tidyverse.org/articles/two-table.html">dplyr two-table verbs
vignette</a> and Jenny
Bryan’s <a href="http://stat545.com/bit001_dplyr-cheatsheet.html">Cheatsheet for dplyr join
functions</a> are also
great resources.</p>
</div>
<div id="gganimate" class="section level3">
<h3>gganimate</h3>
<p>The animations were made possible by the newly re-written
<a href="https://github.com/thomasp85/gganimate#README">gganimate</a> package by
<a href="https://github.com/thomasp85">Thomas Lin Pedersen</a> (original by <a href="https://github.com/dgrtwo">Dave
Robinson</a>). The <a href="https://github.com/thomasp85/gganimate#README">package
readme</a> provides an
excellent (and quick) introduction to gganimate.</p>
</div>
<div id="dynamic-animations" class="section level3">
<h3>Dynamic Animations</h3>
<p>Thanks to an initial push by <a href="https://github.com/DavZim">David Zimmermann</a>, we
have begun work toward a packaged set of functions to generate dynamic
explanatory animations from users’ actual data.
Please visit the <a href="https://github.com/gadenbuie/tidyexplain/tree/pkg">pkg branch</a>
of the tidyexplain repository for more information (or to contribute!).</p>
</div>
</div>
<div id="mutating-joins" class="section level2">
<h2>Mutating Joins</h2>
<blockquote>
<p>A mutating join allows you to combine variables from two tables. It
first matches observations by their keys, then copies across variables
from one table to the other.<br />
<a href="http://r4ds.had.co.nz/relational-data.html#mutating-joins">R for Data Science: Mutating
joins</a></p>
</blockquote>
<p><img src="images/static/png/original-dfs.png" width="480px" /></p>
<pre class="r"><code>x
#&gt; # A tibble: 3 x 2
#&gt;      id x    
#&gt;   &lt;int&gt; &lt;chr&gt;
#&gt; 1     1 x1   
#&gt; 2     2 x2   
#&gt; 3     3 x3
y
#&gt; # A tibble: 3 x 2
#&gt;      id y    
#&gt;   &lt;int&gt; &lt;chr&gt;
#&gt; 1     1 y1   
#&gt; 2     2 y2   
#&gt; 3     4 y4</code></pre>
<div id="inner-join" class="section level3">
<h3>Inner Join</h3>
<blockquote>
<p>All rows from <code>x</code> where there are matching values in <code>y</code>, and all
columns from <code>x</code> and <code>y</code>.</p>
</blockquote>
<p><img src="images/inner-join.gif" /></p>
<pre class="r"><code>inner_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 2 x 3
#&gt;      id x     y    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x1    y1   
#&gt; 2     2 x2    y2</code></pre>
</div>
<div id="left-join" class="section level3">
<h3>Left Join</h3>
<blockquote>
<p>All rows from <code>x</code>, and all columns from <code>x</code> and <code>y</code>. Rows in <code>x</code> with
no match in <code>y</code> will have <code>NA</code> values in the new columns.</p>
</blockquote>
<p><img src="images/left-join.gif" /></p>
<pre class="r"><code>left_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 3 x 3
#&gt;      id x     y    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x1    y1   
#&gt; 2     2 x2    y2   
#&gt; 3     3 x3    &lt;NA&gt;</code></pre>
</div>
<div id="left-join-extra-rows-in-y" class="section level3">
<h3>Left Join (Extra Rows in y)</h3>
<blockquote>
<p>… If there are multiple matches between <code>x</code> and <code>y</code>, all combinations
of the matches are returned.</p>
</blockquote>
<p><img src="images/left-join-extra.gif" /></p>
<pre class="r"><code>y_extra # has multiple rows with the key from `x`
#&gt; # A tibble: 4 x 2
#&gt;      id y    
#&gt;   &lt;dbl&gt; &lt;chr&gt;
#&gt; 1     1 y1   
#&gt; 2     2 y2   
#&gt; 3     4 y4   
#&gt; 4     2 y5
left_join(x, y_extra, by = &quot;id&quot;)
#&gt; # A tibble: 4 x 3
#&gt;      id x     y    
#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x1    y1   
#&gt; 2     2 x2    y2   
#&gt; 3     2 x2    y5   
#&gt; 4     3 x3    &lt;NA&gt;</code></pre>
</div>
<div id="right-join" class="section level3">
<h3>Right Join</h3>
<blockquote>
<p>All rows from y, and all columns from <code>x</code> and <code>y</code>. Rows in <code>y</code> with no
match in <code>x</code> will have <code>NA</code> values in the new columns.</p>
</blockquote>
<p><img src="images/right-join.gif" /></p>
<pre class="r"><code>right_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 3 x 3
#&gt;      id x     y    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x1    y1   
#&gt; 2     2 x2    y2   
#&gt; 3     4 &lt;NA&gt;  y4</code></pre>
</div>
<div id="full-join" class="section level3">
<h3>Full Join</h3>
<blockquote>
<p>All rows and all columns from both <code>x</code> and <code>y</code>. Where there are not
matching values, returns <code>NA</code> for the one missing.</p>
</blockquote>
<p><img src="images/full-join.gif" /></p>
<pre class="r"><code>full_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 4 x 3
#&gt;      id x     y    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x1    y1   
#&gt; 2     2 x2    y2   
#&gt; 3     3 x3    &lt;NA&gt; 
#&gt; 4     4 &lt;NA&gt;  y4</code></pre>
</div>
</div>
<div id="filtering-joins" class="section level2">
<h2>Filtering Joins</h2>
<blockquote>
<p>Filtering joins match observations in the same way as mutating joins,
but affect the observations, not the variables. … Semi-joins are
useful for matching filtered summary tables back to the original rows.
… Anti-joins are useful for diagnosing join mismatches.<br />
<a href="http://r4ds.had.co.nz/relational-data.html#filtering-joins">R for Data Science: Filtering
Joins</a></p>
</blockquote>
<div id="semi-join" class="section level3">
<h3>Semi Join</h3>
<blockquote>
<p>All rows from <code>x</code> where there are matching values in <code>y</code>, keeping just
columns from <code>x</code>.</p>
</blockquote>
<p><img src="images/semi-join.gif" /></p>
<pre class="r"><code>semi_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 2 x 2
#&gt;      id x    
#&gt;   &lt;int&gt; &lt;chr&gt;
#&gt; 1     1 x1   
#&gt; 2     2 x2</code></pre>
</div>
<div id="anti-join" class="section level3">
<h3>Anti Join</h3>
<blockquote>
<p>All rows from <code>x</code> where there are not matching values in <code>y</code>, keeping
just columns from <code>x</code>.</p>
</blockquote>
<p><img src="images/anti-join.gif" /></p>
<pre class="r"><code>anti_join(x, y, by = &quot;id&quot;)
#&gt; # A tibble: 1 x 2
#&gt;      id x    
#&gt;   &lt;int&gt; &lt;chr&gt;
#&gt; 1     3 x3</code></pre>
</div>
</div>
<div id="set-operations" class="section level2">
<h2>Set Operations</h2>
<blockquote>
<p>Set operations are occasionally useful when you want to break a single
complex filter into simpler pieces. All these operations work with a
complete row, comparing the values of every variable. These expect the
x and y inputs to have the same variables, and treat the observations
like sets.<br />
<a href="http://r4ds.had.co.nz/relational-data.html#set-operations">R for Data Science: Set
operations</a></p>
</blockquote>
<p><img src="images/static/png/original-dfs-set-ops.png" width="480px" /></p>
<pre class="r"><code>x
#&gt; # A tibble: 3 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a    
#&gt; 2 1     b    
#&gt; 3 2     a
y 
#&gt; # A tibble: 2 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a    
#&gt; 2 2     b</code></pre>
<div id="union" class="section level3">
<h3>Union</h3>
<blockquote>
<p>All unique rows from <code>x</code> and <code>y</code>.</p>
</blockquote>
<p><img src="images/union.gif" /></p>
<pre class="r"><code>union(x, y)
#&gt; # A tibble: 4 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 2     b    
#&gt; 2 2     a    
#&gt; 3 1     b    
#&gt; 4 1     a</code></pre>
<p><img src="images/union-rev.gif" /></p>
<pre class="r"><code>union(y, x)
#&gt; # A tibble: 4 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 2     a    
#&gt; 2 1     b    
#&gt; 3 2     b    
#&gt; 4 1     a</code></pre>
</div>
<div id="union-all" class="section level3">
<h3>Union All</h3>
<blockquote>
<p>All rows from <code>x</code> and <code>y</code>, keeping duplicates.</p>
</blockquote>
<p><img src="images/union-all.gif" /></p>
<pre class="r"><code>union_all(x, y)
#&gt; # A tibble: 5 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a    
#&gt; 2 1     b    
#&gt; 3 2     a    
#&gt; 4 1     a    
#&gt; 5 2     b</code></pre>
</div>
<div id="intersection" class="section level3">
<h3>Intersection</h3>
<blockquote>
<p>Common rows in both <code>x</code> and <code>y</code>, keeping just unique rows.</p>
</blockquote>
<p><img src="images/intersect.gif" /></p>
<pre class="r"><code>intersect(x, y)
#&gt; # A tibble: 1 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a</code></pre>
</div>
<div id="set-difference" class="section level3">
<h3>Set Difference</h3>
<blockquote>
<p>All rows from <code>x</code> which are not also rows in <code>y</code>, keeping just unique
rows.</p>
</blockquote>
<p><img src="images/setdiff.gif" /></p>
<pre class="r"><code>setdiff(x, y)
#&gt; # A tibble: 2 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     b    
#&gt; 2 2     a</code></pre>
<p><img src="images/setdiff-rev.gif" /></p>
<pre class="r"><code>setdiff(y, x)
#&gt; # A tibble: 1 x 2
#&gt;   x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 2     b</code></pre>
</div>
</div>
<div id="tidy-data" class="section level2">
<h2>Tidy Data</h2>
<p><a href="http://r4ds.had.co.nz/tidy-data.html#tidy-data-1">Tidy data</a> follows
the following three rules:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column.</li>
<li>Each observation has its own row.</li>
<li>Each value has its own cell.</li>
</ol>
<p>Many of the tools in the <a href="https://tidyverse.org">tidyverse</a> expect data
to be formatted as a tidy dataset and the
<a href="https://tidyr.tidyverse.org">tidyr</a> package provides functions to help
you organize your data into tidy data.</p>
<p><img src="images/static/png/original-dfs-tidy.png" /></p>
<pre class="r"><code>wide
#&gt; # A tibble: 2 x 4
#&gt;      id x     y     z    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 a     c     e    
#&gt; 2     2 b     d     f
long
#&gt; # A tibble: 6 x 3
#&gt;      id key   val  
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x     a    
#&gt; 2     2 x     b    
#&gt; 3     1 y     c    
#&gt; 4     2 y     d    
#&gt; 5     1 z     e    
#&gt; 6     2 z     f</code></pre>
<div id="spread-and-gather" class="section level3">
<h3>Spread and Gather</h3>
<p><code>spread(data, key, value)</code></p>
<blockquote>
<p>Spread a key-value pair across multiple columns. Use it when an a
column contains observations from multiple variables.</p>
</blockquote>
<p><code>gather(data, key = "key", value = "value", ...)</code></p>
<blockquote>
<p>Gather takes multiple columns and collapses into key-value pairs,
duplicating all other columns as needed. You use <code>gather()</code> when you
notice that your column names are not names of variables, but <em>values</em>
of a variable.</p>
</blockquote>
<p><img src="images/tidyr-spread-gather.gif" /></p>
<pre class="r"><code>gather(wide, key, val, x:z)
#&gt; # A tibble: 6 x 3
#&gt;      id key   val  
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 x     a    
#&gt; 2     2 x     b    
#&gt; 3     1 y     c    
#&gt; 4     2 y     d    
#&gt; 5     1 z     e    
#&gt; 6     2 z     f
spread(long, key, val)
#&gt; # A tibble: 2 x 4
#&gt;      id x     y     z    
#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1     1 a     c     e    
#&gt; 2     2 b     d     f</code></pre>
</div>
</div>
